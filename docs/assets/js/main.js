"use strict";const titleHeader=document.querySelectorAll(".js_fieldset_boxOne"),arrow=document.querySelectorAll(".js_arrow"),content=document.querySelectorAll(".js_boxTwo"),previewName=document.querySelector(".js_preview_name"),previewBorder=document.querySelector(".js_preview_box1"),previewIcons=document.querySelectorAll(".js_card_icon"),previewIconsBorder=document.querySelectorAll(".js_media_item"),radioInputs=document.querySelectorAll(".js_input_palette"),form=document.querySelector(".js_form"),previewJob=document.querySelector(".js_preview_job"),previewImage=document.querySelector(".js_preview_picture"),previewLinks=document.querySelectorAll(".js_preview_link"),defaultName="Nombre Apellido",defaultJob="Front-end developer",cardResetBtn=document.querySelector(".js_card_reset_btn"),fr=new FileReader,fileField=document.querySelector(".js_image_upload_btn"),profileImage=document.querySelector(".js_preview_picture"),profilePreview=document.querySelector(".js_mini_image"),shareBtn=document.querySelector(".js_share_btn"),shareCard=document.querySelector(".js_share_section");for(let e=0;e<titleHeader.length;e++)titleHeader[e].addEventListener("click",()=>{for(let t=0;t<content.length;t++)e===t?(content[t].classList.contains("collapsed")&&content[t].classList.remove("collapsed"),arrow[t].classList.contains("upsideDown")&&arrow[t].classList.remove("upsideDown")):(content[t].classList.add("collapsed"),arrow[t].classList.add("upsideDown"))});const paletteHandler=e=>{const t=e.target.value;previewCard.palette=t,previewName.classList.remove("palette1-color1","palette2-color1","palette3-color1"),previewName.classList.add(`palette${t}-color1`),previewBorder.classList.remove("palette1-color2","palette2-color2","palette3-color2"),previewBorder.classList.add(`palette${t}-color2`),previewIcons.forEach(e=>{e.classList.remove("palette1-color1","palette2-color1","palette3-color1"),e.classList.add(`palette${t}-color1`)}),previewIconsBorder.forEach(e=>{e.classList.remove("palette1-color3","palette2-color3","palette3-color3"),e.classList.add(`palette${t}-color3`)})};radioInputs.forEach(e=>{e.addEventListener("click",paletteHandler)});let previewCard={palette:"1",name:"",job:"",photo:"",email:"",phone:"",linkedin:"",github:""};function handleInputForm(e){const t=e.target.name,r=e.target.value;previewCard[t]=r,renderCard()}function renderCard(){let e="",t="",r=[];switch(previewCard.name){case"":e=defaultName;break;default:e=previewCard.name}switch(previewCard.job){case"":t=defaultJob;break;default:t=previewCard.job}for(let e=0;e<previewLinks.length;e++){switch(previewLinks[e].id){case"phone":r[e]=previewCard.phone;break;case"email":r[e]=previewCard.email;break;case"linkedin":r[e]=previewCard.linkedin;break;case"github":r[e]=previewCard.github}previewLinks[e].href=r[e]}previewName.innerHTML=e,previewJob.innerHTML=t}function emptyFields(){const e=document.querySelectorAll(".js_resetable");for(let t=0;t<e.length;t++)e[t].value=""}function emptyImg(){document.querySelector(".js_cardPic").style="background-image:url(./assets/images/default_image.jpg)";document.querySelector(".js_mini_image").style=""}function resetRadios(){document.querySelector(".js_default_radio").checked=!0}function inputPaletteDefault(){previewName.classList.remove("palette2-color1","palette3-color1"),previewName.classList.add("palette1-color1"),previewBorder.classList.remove("palette2-color2","palette3-color2"),previewBorder.classList.add("palette1-color2");for(const e of previewIcons)e.classList.remove("palette2-color1","palette3-color1"),e.classList.add("palette1-color1");for(const e of previewIconsBorder)e.classList.remove("palette2-color3","palette3-color3"),e.classList.add("palette1-color3")}function resetCardText(){const e=document.querySelector(".js_preview_name"),t=document.querySelector(".js_preview_job");e.innerHTML="Nombre Apellido",t.innerHTML="Front-end developer"}function closeSection(){shareCard.classList.add("collapsed"),console.log(shareCard)}function resetObject(){previewCard={palette:"1",name:"",job:"",photo:"",email:"",phone:"",linkedin:"",github:""}}function handleResetBtn(e){e.preventDefault(),emptyFields(),resetObject(),resetCardText(),emptyImg(),inputPaletteDefault(),resetRadios(),closeSection()}function getImage(e){const t=e.currentTarget.files[0];fr.addEventListener("load",writeImage),fr.readAsDataURL(t)}function writeImage(){profileImage.style.backgroundImage=`url(${fr.result})`,profilePreview.style.backgroundImage=`url(${fr.result})`,previewCard.photo=fr.result}function createLinkSection(e){const t=document.querySelector(".js_box_share_card"),r=document.createElement("p");r.classList.add("form__collapsible__cardText");const o=document.createTextNode("La tarjeta ha sido creada: ");r.appendChild(o);const a=document.createElement("a");a.classList.add("form__collapsible__cardLink");const l=document.createTextNode(e.cardURL);a.setAttribute("href",e.cardURL),a.setAttribute("target","_blank"),a.appendChild(l),t.appendChild(r),t.appendChild(a)}function sendCard(e){e.preventDefault(),fetch("https://awesome-profile-cards.herokuapp.com/card",{method:"POST",body:JSON.stringify(previewCard),headers:{"Content-Type":"application/json"}}).then(e=>e.json()).then(e=>{if(e.success){const t=document.querySelector(".form__collapsible__errorText");null!==t&&t.remove(),createLinkSection(e),shareCard.classList.remove("collapsed"),shareBtn.setAttribute("disabled",!0);const r=document.querySelector(".js_twitter_btn");r.setAttribute("target","_blank"),r.href="https://twitter.com/intent/tweet?text=¡Os%20comparto%20la%20mejor%20tarjeta%20del%20mundo!&url="+e.cardURL}else{console.log("error");const e=document.querySelector(".form__collapsible__errorText");null!==e&&e.remove();const t=document.querySelector(".js_share_box2"),r=document.createElement("p");r.classList.add("form__collapsible__errorText");const o=document.createTextNode("Algo ha ido mal. Asegúrate de rellenar todos los campos y adjuntar una imagen.");r.appendChild(o),t.appendChild(r)}})}form.addEventListener("input",handleInputForm),cardResetBtn.addEventListener("click",handleResetBtn),fileField.addEventListener("change",getImage),shareBtn.addEventListener("click",sendCard);